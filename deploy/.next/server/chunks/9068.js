"use strict";exports.id=9068,exports.ids=[9068],exports.modules={9523:(e,r,t)=>{t.d(r,{J:()=>u});var a=t(89812),i=t(49837),s=t(60064),n=i.forwardRef((e,r)=>(0,a.jsx)(s.sG.label,{...e,ref:r,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));n.displayName="Label";var o=t(49602),l=t(87677);let d=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef(({className:e,...r},t)=>(0,a.jsx)(n,{ref:t,className:(0,l.cn)(d(),e),...r}));u.displayName=n.displayName},16138:(e,r,t)=>{t.d(r,{A:()=>a});let a=(0,t(65519).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},32063:(e,r,t)=>{t.r(r),t.d(r,{"005bd5b1efeb88d36ab0f467ace01f0a3068f30be9":()=>m,"40aca6f34dda9ee9328ad2d87ff81ca62a58ff21cb":()=>c,"40dca538ace24181507799deb34f98758d7024e7e2":()=>f,"6006a75935538ffda01ac23a336913393062bde9e5":()=>u,"60a2541c447397bdff2adcda1aa27d6fda140e754e":()=>d});var a=t(19660);t(73434);var i=t(86504),s=t(8763);async function n(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL,r=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e||!r)return console.warn("[Server Client] Supabase environment variables not found"),null;try{let t=await (0,s.UL)();return(0,i.createServerClient)(e,r,{cookies:{get:e=>t.get(e)?.value,set(e,r,a){try{t.set(e,r,a)}catch{}},remove(e,r){try{t.set(e,"",{...r,maxAge:0})}catch{}}}})}catch(e){return console.error("[Server Client] Error creating Supabase client:",e),null}}var o=t(90946);function l(){if(process.env.NEXT_PUBLIC_SITE_URL)return process.env.NEXT_PUBLIC_SITE_URL;if(process.env.VERCEL_URL)return`https://${process.env.VERCEL_URL}`;try{let e=(0,s.b3)(),r=e.get("host"),t=e.get("x-forwarded-proto")||"http";if(r)return`${t}://${r}`}catch(e){console.warn("Could not get site URL from headers:",e)}return"http://localhost:3000"}async function d(e,r){let t=await n();if(!t)return{error:"Database connection failed"};try{let{error:a,data:i}=await t.auth.signInWithPassword({email:e,password:r});if(a)return{error:a.message};if(i.user&&!i.user.email_confirmed_at)return await t.auth.signOut(),{error:"Please verify your email first! We sent you a confirmation link.",code:"EMAIL_NOT_VERIFIED"};return i.user&&(console.log(`[v0] User ${i.user.email} logged in successfully`),await t.from("users").update({last_login:new Date().toISOString(),login_count:t.rpc("increment",{row_id:i.user.id})}).eq("email",i.user.email)),{success:!0}}catch(e){return console.error("Login error:",e),{error:"An unexpected error occurred. Please try again."}}}async function u(e,r){if(!r)return{error:"Form data is missing"};let t=r.get("email"),a=r.get("password"),i=r.get("password2"),s=r.get("deviceFingerprint");if(!t||!a)return{error:"Email and password are required"};if(!i||a.toString()!==i.toString())return{error:"Passwords do not match"};let o=await n();if(!o)return{error:"Database connection failed"};try{let{data:e}=await o.auth.admin.listUsers();if(e.users.some(e=>e.email===t.toString()))return{error:"Email already registered",code:"EMAIL_EXISTS"};let r=l(),{error:i,data:n}=await o.auth.signUp({email:t.toString(),password:a.toString(),options:{emailRedirectTo:`${r}/auth/callback`,data:{email:t.toString(),registration_source:"web",device_fingerprint:s?.toString()||null}}});if(i)return{error:i.message};if(n.user){let{error:e}=await o.from("users").insert({email:n.user.email,supabase_id:n.user.id,device_fingerprint:s?.toString()||null,registration_ip:"127.0.0.1",last_ip:"127.0.0.1",is_admin:"ysnyuki2321@outlook.jp"===t.toString(),auth_provider:"email",is_verified:!1,subscription_type:"free",storage_used:0,storage_limit:0x80000000,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),email_verification_sent_at:new Date().toISOString(),verification_attempts:0});e&&console.error("[v0] Failed to insert user record:",e),console.log(`[v0] User ${n.user.email} registered successfully`)}try{let{data:e}=await o.from("admin_settings").select("setting_key, setting_value"),r=(e||[]).reduce((e,r)=>(e[r.setting_key]=r.setting_value,e),{});"true"===r.auth_auto_verify&&n.user?.email&&await o.from("users").update({is_verified:!0,supabase_id:n.user.id}).eq("email",n.user.email)}catch(e){console.warn("[v0] Failed to auto-verify user:",e)}return{success:"Check your email to confirm your account. If you don't see it, check your spam folder.",userId:n.user?.id}}catch(e){return console.error("Sign up error:",e),{error:"An unexpected error occurred. Please try again."}}}async function c(e){let r=await n();if(!r)return{error:"Database connection failed"};try{let{data:t,error:a}=await r.from("users").select("is_verified, verification_attempts, email_verification_sent_at").eq("email",e).single();if(a||!t)return{error:"User not found"};if(t.is_verified)return{error:"Email is already verified"};let i=t.email_verification_sent_at?new Date(t.email_verification_sent_at):null,s=new Date;if((i?(s.getTime()-i.getTime())/36e5:24)<1&&t.verification_attempts>=3)return{error:"Too many verification attempts. Please wait 1 hour before trying again."};let{error:n}=await r.auth.resend({type:"signup",email:e});if(n)return{error:n.message};return await r.from("users").update({email_verification_sent_at:new Date().toISOString(),verification_attempts:t.verification_attempts+1}).eq("email",e),{success:"Verification email sent! Please check your inbox and spam folder."}}catch(e){return console.error("Resend verification error:",e),{error:"Failed to send verification email. Please try again."}}}async function f(e){let r=await n();if(!r)return{error:"Database connection failed"};try{let{data:t,error:a}=await r.from("users").select("email, password_reset_attempts, password_reset_sent_at").eq("email",e).single();if(a||!t)return{success:"If an account with this email exists, you will receive a password reset link."};let i=t.password_reset_sent_at?new Date(t.password_reset_sent_at):null,s=new Date;if((i?(s.getTime()-i.getTime())/36e5:24)<1&&t.password_reset_attempts>=3)return{error:"Too many password reset attempts. Please wait 1 hour before trying again."};let n=l(),{error:o}=await r.auth.resetPasswordForEmail(e,{redirectTo:`${n}/auth/reset-password`});if(o)return{error:o.message};return await r.from("users").update({password_reset_sent_at:new Date().toISOString(),password_reset_attempts:(t.password_reset_attempts||0)+1}).eq("email",e),{success:"Password reset email sent! Please check your inbox and spam folder."}}catch(e){return console.error("Forgot password error:",e),{error:"Failed to send password reset email. Please try again."}}}async function m(){let e=await n();e&&await e.auth.signOut(),(0,o.redirect)("/auth/login")}(0,t(73734).D)([d,u,c,f,m]),(0,a.A)(d,"60a2541c447397bdff2adcda1aa27d6fda140e754e",null),(0,a.A)(u,"6006a75935538ffda01ac23a336913393062bde9e5",null),(0,a.A)(c,"40aca6f34dda9ee9328ad2d87ff81ca62a58ff21cb",null),(0,a.A)(f,"40dca538ace24181507799deb34f98758d7024e7e2",null),(0,a.A)(m,"005bd5b1efeb88d36ab0f467ace01f0a3068f30be9",null)},40576:(e,r,t)=>{t.d(r,{A:()=>a});let a=(0,t(65519).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},60064:(e,r,t)=>{t.d(r,{hO:()=>l,sG:()=>o});var a=t(49837),i=t(69056),s=t(1317),n=t(89812),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let t=a.forwardRef((e,t)=>{let{asChild:a,...i}=e,o=a?s.DX:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(o,{...i,ref:t})});return t.displayName=`Primitive.${r}`,{...e,[r]:t}},{});function l(e,r){e&&i.flushSync(()=>e.dispatchEvent(r))}},73438:(e,r,t)=>{t.d(r,{A:()=>a});let a=(0,t(65519).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},76576:(e,r,t)=>{t.d(r,{p:()=>s});var a=t(89812);t(49837);var i=t(87677);function s({className:e,type:r,...t}){return(0,a.jsx)("input",{type:r,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...t})}},76614:(e,r,t)=>{t.d(r,{A:()=>a});let a=(0,t(65519).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},85005:(e,r,t)=>{t.d(r,{n:()=>i});var a=t(54524);let i=(0,a.createServerReference)("40aca6f34dda9ee9328ad2d87ff81ca62a58ff21cb",a.callServer,void 0,a.findSourceMapURL,"resendVerificationEmail")}};